# WebApp
This is based on the sample application generated by the Eclipse Foundation starter for Jakarta EE.

## How to Create the client-cert
Following are the steps to create a client-cert. And then import it to the autogenerated key.p12 file of the Server.
Some of the commands require some inputs afterwards. Simply provide some meaningfull

1. Create the Certificate Authority (CA) private key
```
openssl ecparam -name prime256v1 -genkey -noout -out ca.key
```
2. Create the CA Certificate
```
openssl req -new -x509 -sha256 -key ca.key -out ca.crt
```
3. Create the Client Certificate private key
```
openssl ecparam -name prime256v1 -genkey -noout -out client.key
```
4. Generate the Client Cert signing Request (Important: the CN from the prompt during this step must be the same as the username defined in the server.xml)
```
openssl req -new -sha256 -key client.key -out client.csr
```
5. Generate the Client Certificate
```
openssl x509 -req -in client.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out client.crt -days 1000 -sha256
```
6. Combine certificate and key
```
openssl pkcs12 -export -out client.p12 -inkey client.key -in client.crt
```
7. Start the application server, so that the server will generate a selfsigned key.p12 file.
```
./mvnw liberty:dev
```
8. Stop the application server after the server started successfully.
Ctrl + C
9. Import the Combine p12 file to the key.p12 (Keytool is from the jdk, the password is the one defined in settings.xml)
```
keytool -importcert -keystore target/liberty/wlp/usr/servers/defaultServer/resources/security/key.p12 -storepass password -alias api -file client.cert
```
10. Start the server again
```
./mvnw liberty:dev
```
11. Call the server using curl and verify the CN (Check the Response it should say Name: CN=API....)
```
curl --tls-max 1.2 -v --key client.key --cert ./client.crt -k --insecure https://localhost:9443/certinf.jsp
```
12. Call the Secure endpoint
```
curl tls-max 1.2 -v --key client.key --cert ./client.crt -k --insecure https://localhost:9443/rest/secure/hello
```


## Start of the Server

You can run the application by executing the following command from the directory where this file resides. Please ensure you have installed a [Java SE 8+ implementation](https://adoptium.net/?variant=openjdk8) appropriate for your Jakarta EE version and runtime choice (we have tested with Java SE 8, Java SE 11 and Java SE 17). Note, the [Maven Wrapper](https://maven.apache.org/wrapper/) is already included in the project, so a Maven install is not actually needed. You may first need to execute `chmod +x mvnw`.

```
./mvnw liberty:dev
```

Once the runtime starts, you can access the project at https://localhost:9443.


```
./mvnw clean package
docker build -t jakartaee-hello-world:v1 .
```

You can then run the Docker image by executing:

```
docker run -it --rm -p 9080:9080 jakartaee-hello-world:v1
```

Once the runtime starts, you can access the project at http://localhost:9443/.

